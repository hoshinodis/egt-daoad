import{u as a,r as v,s as M,b as o,F as N,j as s,a as L,e as k,f as P,g as D,h as G,d as I,i as O,k as j}from"./index-0222bd03.js";import{u as S,B as V,C as E,H as _}from"./index-35888618.js";import{T as w,C as R,g as A,e as b,O as x,S as B,V as F,f as $,M as H,a as J,b as U,c as W,d as q,h as z}from"./index-97dac3a8.js";const K="/assets/voting-list-of-creatives-aa396a27.svg",Q=()=>{const d=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const l=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),p=e=>async(r,f)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const c=await A();await(await b(l).vote(Number(e),r,f,{gasLimit:5e6,gasPrice:c})).wait(),alert("Vote Successfully")}catch(c){console.log("Err: ",c)}},h=S(),m=a(e=>e.app.advertiserList),i=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return v.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(r=>h(M(JSON.parse(r))))}).catch(()=>alert("something went wrong"))},[]),o(N,{children:[s(w,{className:"my-8",src:K,alt:"my creative"}),s("div",{className:"flex flex-col gap-12",children:i.map((e,r)=>s(R,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:m[r].img,status:u(m[r].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:d,onVote:p(e.id)},e.id))})]})},X="/assets/gt-b4539d83.svg",Y="/assets/publisher-overview-7c397cd6.svg",Z=()=>{const d=a(e=>e.app.MeGTVP),l=a(e=>e.app.rewardMeAmount),n=v.useMemo(()=>l.toLocaleString(),[l]),p=a(e=>e.app.stakingMeTokenBalance),h=v.useMemo(()=>p.toLocaleString(),[p]),m=e=>{alert(`stake: ${e}`)},i=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return o(N,{children:[s(w,{className:"my-8",src:Y,alt:"advertiser overview"}),o("div",{className:"flex gap-12",children:[s(x,{className:"h-48 flex-1",title:"MeGT",icon:X,children:s("p",{className:"text-48-bold text-neutral-10",children:n})}),s(x,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:B,onStake:m,maxVp:d,children:s("p",{className:"text-48-bold text-neutral-10",children:h})}),s(x,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:o("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${i}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),s(x,{className:"h-48 flex-1",title:"VP Regen Speed",icon:$,children:o("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},ee="/assets/new-site-b7987d2e.svg",te=({className:d,onClick:l,isOpen:n,onClose:p,onCreate:h,children:m})=>{const[i,u]=v.useState(""),e=c=>u(c.target.value),r=c=>{u(""),p(c)};return o(N,{children:[s(V,{className:d,color:"secondary",onClick:l,children:m}),o(H,{isOpen:n,onClose:r,children:[s(J,{className:"h-14",children:s(w,{src:ee,alt:"new site"})}),s(U,{children:s(W,{label:"Site URL",value:i,onChange:e,placeholder:"Please enter site URL here"})}),o(q,{children:[s(V,{color:"neutral",onClick:r,children:"CANCEL"}),s(V,{color:"secondary",onClick:c=>{h(i),r(c)},children:"CREATE"})]})]})]})},se="/assets/my-sites-e9cbebca.svg",ae=()=>{const d=a(t=>t.app.MeGTVP),[l,n]=v.useState(!1),p=()=>n(!0),h=()=>n(!1),m=a(t=>t.app.address),i=a(t=>t.app.siteList),u=a(t=>t.app.isAdvertiser),e=a(t=>t.app.daoContract),r=a(t=>t.app.endDate),f=a(t=>t.app.contractSiteList),c=async t=>{const g=Math.floor(new Date().getTime()/1e3)+r*60;try{await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:i.length+1,wallet_address:m,url:t})});const C=await A();await(await b(e).createContent(u,g,t,{gasLimit:5e6,gasPrice:C})).wait(),alert("Create Successfully")}catch(C){console.log("Err: ",C)}},T=S();L.useEffect(()=>{fetch("/api/sites").then(t=>{t.text().then(g=>T(k(Array(g))))}).catch(()=>alert("something went wrong"))},[]);const y=t=>t===1?"passed":t===2?"rejected":"process";return o(N,{children:[o("div",{className:"flex justify-between",children:[s(w,{className:"my-8",src:se,alt:"voting list of sites"}),s("div",{className:"flex items-center",children:s(te,{onClick:p,isOpen:l,onClose:h,onCreate:c,children:"NEW SITE"})})]}),s("div",{className:"flex flex-col gap-12",children:f.map((t,g)=>s(z,{id:t.id!==void 0?t.id.toNumber().toString():t.id,url:i.length>g?i[g].url:"",createdAt:new Date,status:i.length>g?y(i[g].status):"process",expires:new Date,ok:t.agreeVoteAmount!==void 0?t.agreeVoteAmount.toNumber():0,ng:t.rejectVoteAmount!==void 0?t.rejectVoteAmount.toNumber():0,maxVp:d},t.id!==void 0?t.id.toNumber():t.id))})]})},ce=()=>{const d=a(h=>h.app.address),l=P(),n=S();return o(E,{children:[s(_,{address:d,current:"publisher",onDisconnect:()=>{l("/welcome"),n(D(!0)),n(G(!1)),n(I(!1)),n(O(!1)),n(j(""))}}),s(Z,{}),o("div",{className:"flex gap-12",children:[s("div",{className:"flex-[2_1_0%]",children:s(Q,{})}),s("div",{className:"flex-[3_1_0%]",children:s(ae,{})})]})]})};export{ce as Publisher};
