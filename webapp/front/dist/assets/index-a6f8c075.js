import{u as a,r as f,s as L,b as r,F as w,j as t,a as M,e as b,f as P,g as j,h as D,d as G,i as I,k as O}from"./index-30071a11.js";import{u as A,B as C,C as E,H as _}from"./index-6d45b9b0.js";import{T as N,C as R,g as T,e as k,O as v,S as B,V as F,f as $,M as H,a as U,b as J,c as W,d as q,h as z,j as K}from"./voting-list-of-sites-50012991.js";const Q="/assets/voting-list-of-creatives-aa396a27.svg",X=()=>{const p=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const o=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),h=e=>async(i,x)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const l=await T();await(await k(o).vote(Number(e),i,x,{gasLimit:5e6,gasPrice:l})).wait(),alert("Vote Successfully")}catch(l){console.log("Err: ",l)}},m=A(),g=a(e=>e.app.advertiserList),d=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return f.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(i=>m(L(Array(i))))}).catch(()=>alert("something went wrong"))},[]),r(w,{children:[t(N,{className:"my-8",src:Q,alt:"my creative"}),t("div",{className:"flex flex-col gap-12",children:d.map((e,i)=>t(R,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:g[i].img,status:u(g[i].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:p,onVote:h(e.id)},e.id))})]})},Y="/assets/gt-b4539d83.svg",Z="/assets/publisher-overview-7c397cd6.svg",ee=()=>{const p=a(e=>e.app.MeGTVP),o=a(e=>e.app.rewardMeAmount),n=f.useMemo(()=>o.toLocaleString(),[o]),h=a(e=>e.app.stakingMeTokenBalance),m=f.useMemo(()=>h.toLocaleString(),[h]),g=e=>{alert(`stake: ${e}`)},d=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return r(w,{children:[t(N,{className:"my-8",src:Z,alt:"advertiser overview"}),r("div",{className:"flex gap-12",children:[t(v,{className:"h-48 flex-1",title:"MeGT",icon:Y,children:t("p",{className:"text-48-bold text-neutral-10",children:n})}),t(v,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:B,onStake:g,maxVp:p,children:t("p",{className:"text-48-bold text-neutral-10",children:m})}),t(v,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:r("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${d}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),t(v,{className:"h-48 flex-1",title:"VP Regen Speed",icon:$,children:r("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},te="/assets/new-site-b7987d2e.svg",se=({className:p,onClick:o,isOpen:n,onClose:h,onCreate:m,children:g})=>{const[d,u]=f.useState(""),e=l=>u(l.target.value),i=l=>{u(""),h(l)};return r(w,{children:[t(C,{className:p,color:"secondary",onClick:o,children:g}),r(H,{isOpen:n,onClose:i,children:[t(U,{className:"h-14",children:t(N,{src:te,alt:"new site"})}),t(J,{children:t(W,{label:"Site URL",value:d,onChange:e,placeholder:"Please enter site URL here"})}),r(q,{children:[t(C,{color:"neutral",onClick:i,children:"CANCEL"}),t(C,{color:"secondary",onClick:l=>{m(d),i(l)},children:"CREATE"})]})]})]})},ae=()=>{const p=a(s=>s.app.MeGTVP),[o,n]=f.useState(!1),h=()=>n(!0),m=()=>n(!1),g=a(s=>s.app.address),d=a(s=>s.app.siteList),u=a(s=>s.app.isAdvertiser),e=a(s=>s.app.daoContract),i=a(s=>s.app.endDate),x=a(s=>s.app.contractSiteList),l=async s=>{console.log("a;slkdjgalskjg;lajsdlgjadskgj;ajkg");const c=Math.floor(new Date().getTime()/1e3)+i*60;try{await fetch("/api/sites",{method:"POST",body:JSON.stringify({id:d.length+1,wallet_address:g,url:s})});const S=await T();await(await k(e).createContent(u,c,s,{gasLimit:5e6,gasPrice:S})).wait(),alert("Create Successfully")}catch(S){console.log("Err: ",S)}},V=A();M.useEffect(()=>{fetch("/api/sites").then(s=>{s.text().then(c=>V(b(Array(c))))}).catch(()=>alert("something went wrong"))},[]);const y=s=>s===1?"passed":s===2?"rejected":"process";return r(w,{children:[r("div",{className:"flex justify-between",children:[t(N,{className:"my-8",src:z,alt:"voting list of sites"}),t("div",{className:"flex items-center",children:t(se,{onClick:h,isOpen:o,onClose:m,onCreate:l,children:"NEW SITE"})})]}),t("div",{className:"flex flex-col gap-12",children:x.map((s,c)=>t(K,{id:s[c].id,url:d[c].url,createdAt:new Date(s[c].createdAt*1e3),status:y(d[c].status),expires:new Date(s[c].endAt*1e3),ok:s[c].agreeVoteAmount,ng:s[c].rejectVoteAmount,maxVp:p},s[c].id))})]})},le=()=>{const p=a(m=>m.app.address),o=P(),n=A();return r(E,{children:[t(_,{address:p,current:"publisher",onDisconnect:()=>{o("/welcome"),n(j(!0)),n(D(!1)),n(G(!1)),n(I(!1)),n(O(""))}}),t(ee,{}),r("div",{className:"flex gap-12",children:[t("div",{className:"flex-[2_1_0%]",children:t(X,{})}),t("div",{className:"flex-[3_1_0%]",children:t(ae,{})})]})]})};export{le as Publisher};
