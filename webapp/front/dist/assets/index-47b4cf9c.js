import{u as a,r as v,s as k,b as i,F as w,j as s,a as C,e as L,f as M,g as P,h as D,d as j,i as G,k as I}from"./index-8196b0c1.js";import{u as A,C as O,H as E}from"./index-e0bd44aa.js";import{T as V,C as _,g as b,e as y,O as f,S as $,V as F,f as H,h as J,N as B,j as R}from"./my-sites-0a379f6c.js";const U="/assets/voting-list-of-creatives-aa396a27.svg",W=()=>{const c=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const r=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),l=e=>async(o,x)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const g=await b();await(await y(r).vote(Number(e),o,x,{gasLimit:5e6,gasPrice:g})).wait(),alert("Vote Successfully")}catch(g){console.log("Err: ",g)}},d=A(),m=a(e=>e.app.advertiserList),p=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return v.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(o=>d(k(JSON.parse(o))))}).catch(()=>alert("something went wrong"))},[]),i(w,{children:[s(V,{className:"my-8",src:U,alt:"my creative"}),s("div",{className:"flex flex-col gap-12",children:p.map((e,o)=>s(_,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:m[o].img,status:u(m[o].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:c,onVote:l(e.id)},e.id))})]})},q="/assets/gt-b4539d83.svg",z="/assets/publisher-overview-7c397cd6.svg",K=()=>{const c=a(e=>e.app.MeGTVP),r=a(e=>e.app.rewardMeAmount),n=v.useMemo(()=>r.toLocaleString(),[r]),l=a(e=>e.app.stakingMeTokenBalance),d=v.useMemo(()=>l.toLocaleString(),[l]),m=e=>{alert(`stake: ${e}`)},p=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return i(w,{children:[s(V,{className:"my-8",src:z,alt:"advertiser overview"}),i("div",{className:"flex gap-12",children:[s(f,{className:"h-48 flex-1",title:"MeGT",icon:q,children:s("p",{className:"text-48-bold text-neutral-10",children:n})}),s(f,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:$,onStake:m,maxVp:c,children:s("p",{className:"text-48-bold text-neutral-10",children:d})}),s(f,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:i("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${p}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),s(f,{className:"h-48 flex-1",title:"VP Regen Speed",icon:H,children:i("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},Q=()=>{const c=a(t=>t.app.MeGTVP),[r,n]=v.useState(!1),l=()=>n(!0),d=()=>n(!1),m=a(t=>t.app.address),p=a(t=>t.app.siteList),u=a(t=>t.app.isAdvertiser),e=a(t=>t.app.daoContract),o=a(t=>t.app.endDate),x=a(t=>t.app.contractSiteList),g=async t=>{const h=Math.floor(new Date().getTime()/1e3)+o*60;try{await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p.length+1,wallet_address:m,url:t})});const N=await b();await(await y(e).createContent(u,h,t,{gasLimit:5e6,gasPrice:N})).wait(),alert("Create Successfully")}catch(N){console.log("Err: ",N)}},T=A();C.useEffect(()=>{fetch("/api/sites").then(t=>{t.text().then(h=>T(L(Array(h))))}).catch(()=>alert("something went wrong"))},[]);const S=t=>t===1?"passed":t===2?"rejected":"process";return i(w,{children:[i("div",{className:"flex justify-between",children:[s(V,{className:"my-8",src:J,alt:"voting list of sites"}),s("div",{className:"flex items-center",children:s(B,{onClick:l,isOpen:r,onClose:d,onCreate:g,children:"NEW SITE"})})]}),s("div",{className:"flex flex-col gap-12",children:x.map((t,h)=>s(R,{id:t.id!==void 0?t.id.toNumber().toString():t.id,url:t.siteUrl,createdAt:new Date(t.createdAt!==void 0?t.createdAt.toNumber()*1e3:0),status:p.length>h?S(p[h].status):"process",expires:new Date(t.endAt!==void 0?t.endAt.toNumber()*1e3:0),ok:t.agreeVoteAmount!==void 0?t.agreeVoteAmount.toNumber():0,ng:t.rejectVoteAmount!==void 0?t.rejectVoteAmount.toNumber():0,maxVp:c},t.id!==void 0?t.id.toNumber():t.id))})]})},te=()=>{const c=a(d=>d.app.address),r=M(),n=A();return i(O,{children:[s(E,{address:c,current:"publisher",onDisconnect:()=>{r("/welcome"),n(P(!0)),n(D(!1)),n(j(!1)),n(G(!1)),n(I(""))}}),s(K,{}),i("div",{className:"flex gap-12",children:[s("div",{className:"flex-[2_1_0%]",children:s(W,{})}),s("div",{className:"flex-[3_1_0%]",children:s(Q,{})})]})]})};export{te as Publisher};
