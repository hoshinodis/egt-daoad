import{u as a,r as x,s as S,b as i,F as w,j as s,a as k,e as C,f as L,g as M,h as P,d as D,i as j,k as G}from"./index-7f7a609a.js";import{u as V,C as I,H as O}from"./index-21e7dfc1.js";import{T as A,C as E,g as b,e as y,O as f,S as _,V as $,f as F,h as H,N as J,j as B}from"./my-sites-b76a938c.js";const R="/assets/voting-list-of-creatives-aa396a27.svg",U=()=>{const c=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const r=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),l=e=>async(o,v)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const g=await b();await(await y(r).vote(Number(e),o,v,{gasLimit:5e6,gasPrice:g})).wait(),alert("Vote Successfully")}catch(g){console.log("Err: ",g)}},d=V(),m=a(e=>e.app.advertiserList),p=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return x.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(o=>d(S(JSON.parse(o))))}).catch(()=>alert("something went wrong"))},[]),i(w,{children:[s(A,{className:"my-8",src:R,alt:"my creative"}),s("div",{className:"flex flex-col gap-12",children:p.map((e,o)=>s(E,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:m[o].img,status:u(m[o].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:c,onVote:l(e.id)},e.id))})]})},W="/assets/gt-b4539d83.svg",q="/assets/publisher-overview-7c397cd6.svg",z=()=>{const c=a(e=>e.app.MeGTVP),r=a(e=>e.app.rewardMeAmount),n=x.useMemo(()=>r.toLocaleString(),[r]),l=a(e=>e.app.stakingMeTokenBalance),d=x.useMemo(()=>l.toLocaleString(),[l]),m=e=>{alert(`stake: ${e}`)},p=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return i(w,{children:[s(A,{className:"my-8",src:q,alt:"advertiser overview"}),i("div",{className:"flex gap-12",children:[s(f,{className:"h-48 flex-1",title:"MeGT",icon:W,children:s("p",{className:"text-48-bold text-neutral-10",children:n})}),s(f,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:_,onStake:m,maxVp:c,children:s("p",{className:"text-48-bold text-neutral-10",children:d})}),s(f,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:$,children:i("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${p}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),s(f,{className:"h-48 flex-1",title:"VP Regen Speed",icon:F,children:i("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},K=()=>{const c=a(t=>t.app.MeGTVP),[r,n]=x.useState(!1),l=()=>n(!0),d=()=>n(!1),m=a(t=>t.app.address),p=a(t=>t.app.siteList);a(t=>t.app.isAdvertiser);const u=a(t=>t.app.daoContract),e=a(t=>t.app.endDate),o=a(t=>t.app.contractSiteList),v=async t=>{const h=Math.floor(new Date().getTime()/1e3)+e*60;try{await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p.length+1,wallet_address:m,url:t})});const N=await b();await(await y(u).createContent(!1,h,t,{gasLimit:5e6,gasPrice:N})).wait(),alert("Create Successfully")}catch(N){console.log("Err: ",N)}},g=V();k.useEffect(()=>{fetch("/api/sites").then(t=>{t.text().then(h=>g(C(Array(h))))}).catch(()=>alert("something went wrong"))},[]);const T=t=>t===1?"passed":t===2?"rejected":"process";return i(w,{children:[i("div",{className:"flex justify-between",children:[s(A,{className:"my-8",src:H,alt:"voting list of sites"}),s("div",{className:"flex items-center",children:s(J,{onClick:l,isOpen:r,onClose:d,onCreate:v,children:"NEW SITE"})})]}),s("div",{className:"flex flex-col gap-12",children:o.map((t,h)=>s(B,{id:t.id!==void 0?t.id.toNumber().toString():t.id,url:t.siteUrl,createdAt:new Date(t.createdAt!==void 0?t.createdAt.toNumber()*1e3:0),status:p.length>h?T(p[h].status):"process",expires:new Date(t.endAt!==void 0?t.endAt.toNumber()*1e3:0),ok:t.agreeVoteAmount!==void 0?t.agreeVoteAmount.toNumber():0,ng:t.rejectVoteAmount!==void 0?t.rejectVoteAmount.toNumber():0,maxVp:c},t.id!==void 0?t.id.toNumber():t.id))})]})},ee=()=>{const c=a(d=>d.app.address),r=L(),n=V();return i(I,{children:[s(O,{address:c,current:"publisher",onDisconnect:()=>{r("/welcome"),n(M(!0)),n(P(!1)),n(D(!1)),n(j(!1)),n(G(""))}}),s(z,{}),i("div",{className:"flex gap-12",children:[s("div",{className:"flex-[2_1_0%]",children:s(U,{})}),s("div",{className:"flex-[3_1_0%]",children:s(K,{})})]})]})};export{ee as Publisher};
