import{u as a,r as f,s as b,b as l,F as w,j as t,a as L,e as k,f as P,g as D,h as G,d as I,i as E,k as O}from"./index-d154d907.js";import{u as T,B as C,C as j,H as _}from"./index-01841c50.js";import{T as N,C as R,g as A,e as y,O as v,S as B,V as F,f as $,M as H,a as U,b as J,c as W,d as q,h as z}from"./index-6bee4de5.js";const K="/assets/voting-list-of-creatives-aa396a27.svg",Q=()=>{const p=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const d=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),h=e=>async(i,x)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const o=await A();await(await y(d).vote(Number(e),i,x,{gasLimit:5e6,gasPrice:o})).wait(),alert("Vote Successfully")}catch(o){console.log("Err: ",o)}},m=T(),u=a(e=>e.app.advertiserList),c=a(e=>e.app.contractAdvertiserList),g=e=>e===1?"passed":e===2?"rejected":"process";return f.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(i=>m(b(Array(i))))}).catch(()=>alert("something went wrong"))},[]),l(w,{children:[t(N,{className:"my-8",src:K,alt:"my creative"}),t("div",{className:"flex flex-col gap-12",children:c.map((e,i)=>t(R,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:u[i].img,status:g(u[i].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:p,onVote:h(e.id)},e.id))})]})},X="/assets/gt-b4539d83.svg",Y="/assets/publisher-overview-7c397cd6.svg",Z=()=>{const p=a(e=>e.app.MeGTVP),d=a(e=>e.app.rewardMeAmount),n=f.useMemo(()=>d.toLocaleString(),[d]),h=a(e=>e.app.stakingMeTokenBalance),m=f.useMemo(()=>h.toLocaleString(),[h]),u=e=>{alert(`stake: ${e}`)},c=a(e=>e.app.MeGTVP),g=a(e=>e.app.MeGTVPTime);return l(w,{children:[t(N,{className:"my-8",src:Y,alt:"advertiser overview"}),l("div",{className:"flex gap-12",children:[t(v,{className:"h-48 flex-1",title:"MeGT",icon:X,children:t("p",{className:"text-48-bold text-neutral-10",children:n})}),t(v,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:B,onStake:u,maxVp:p,children:t("p",{className:"text-48-bold text-neutral-10",children:m})}),t(v,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:l("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${c}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),t(v,{className:"h-48 flex-1",title:"VP Regen Speed",icon:$,children:l("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${g}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},ee="/assets/new-site-b7987d2e.svg",te=({className:p,onClick:d,isOpen:n,onClose:h,onCreate:m,children:u})=>{const[c,g]=f.useState(""),e=o=>g(o.target.value),i=o=>{g(""),h(o)};return l(w,{children:[t(C,{className:p,color:"secondary",onClick:d,children:u}),l(H,{isOpen:n,onClose:i,children:[t(U,{className:"h-14",children:t(N,{src:ee,alt:"new site"})}),t(J,{children:t(W,{label:"Site URL",value:c,onChange:e,placeholder:"Please enter site URL here"})}),l(q,{children:[t(C,{color:"neutral",onClick:i,children:"CANCEL"}),t(C,{color:"secondary",onClick:o=>{m(c),i(o)},children:"CREATE"})]})]})]})},se="/assets/my-sites-e9cbebca.svg",ae=()=>{const p=a(s=>s.app.MeGTVP),[d,n]=f.useState(!1),h=()=>n(!0),m=()=>n(!1),u=a(s=>s.app.address),c=a(s=>s.app.siteList),g=a(s=>s.app.isAdvertiser),e=a(s=>s.app.daoContract),i=a(s=>s.app.endDate),x=a(s=>s.app.contractSiteList),o=async s=>{const r=Math.floor(new Date().getTime()/1e3)+i*60;try{await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c.length+1,wallet_address:u,url:s})});const S=await A();await(await y(e).createContent(g,r,s,{gasLimit:5e6,gasPrice:S})).wait(),alert("Create Successfully")}catch(S){console.log("Err: ",S)}},V=T();L.useEffect(()=>{fetch("/api/sites").then(s=>{s.text().then(r=>V(k(Array(r))))}).catch(()=>alert("something went wrong"))},[]);const M=s=>s===1?"passed":s===2?"rejected":"process";return l(w,{children:[l("div",{className:"flex justify-between",children:[t(N,{className:"my-8",src:se,alt:"voting list of sites"}),t("div",{className:"flex items-center",children:t(te,{onClick:h,isOpen:d,onClose:m,onCreate:o,children:"NEW SITE"})})]}),t("div",{className:"flex flex-col gap-12",children:x.map((s,r)=>t(z,{id:s[r].id,url:c.length>r?c[r].url:"",createdAt:new Date,status:c.length>r?M(c[r].status):"process",expires:new Date,ok:s[r].agreeVoteAmount,ng:s[r].rejectVoteAmount,maxVp:p},s[r].id))})]})},le=()=>{const p=a(m=>m.app.address),d=P(),n=T();return l(j,{children:[t(_,{address:p,current:"publisher",onDisconnect:()=>{d("/welcome"),n(D(!0)),n(G(!1)),n(I(!1)),n(E(!1)),n(O(""))}}),t(Z,{}),l("div",{className:"flex gap-12",children:[t("div",{className:"flex-[2_1_0%]",children:t(Q,{})}),t("div",{className:"flex-[3_1_0%]",children:t(ae,{})})]})]})};export{le as Publisher};
