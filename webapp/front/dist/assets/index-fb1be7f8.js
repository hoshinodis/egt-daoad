import{u as a,r as v,s as S,b as r,F as N,j as s,a as L,e as k,f as P,g as D,h as G,d as I,i as O,k as j}from"./index-85fd3c49.js";import{u as V,B as C,C as E,H as _}from"./index-4c47235d.js";import{T as w,C as R,g as T,e as y,O as x,S as B,V as F,f as U,M as $,a as H,b as J,c as W,d as q,h as z}from"./index-3c140a26.js";const K="/assets/voting-list-of-creatives-aa396a27.svg",Q=()=>{const d=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const l=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),p=e=>async(i,f)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const o=await T();await(await y(l).vote(Number(e),i,f,{gasLimit:5e6,gasPrice:o})).wait(),alert("Vote Successfully")}catch(o){console.log("Err: ",o)}},h=V(),m=a(e=>e.app.advertiserList),c=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return v.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(i=>h(S(JSON.parse(i))))}).catch(()=>alert("something went wrong"))},[]),r(N,{children:[s(w,{className:"my-8",src:K,alt:"my creative"}),s("div",{className:"flex flex-col gap-12",children:c.map((e,i)=>s(R,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:m[i].img,status:u(m[i].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:d,onVote:p(e.id)},e.id))})]})},X="/assets/gt-b4539d83.svg",Y="/assets/publisher-overview-7c397cd6.svg",Z=()=>{const d=a(e=>e.app.MeGTVP),l=a(e=>e.app.rewardMeAmount),n=v.useMemo(()=>l.toLocaleString(),[l]),p=a(e=>e.app.stakingMeTokenBalance),h=v.useMemo(()=>p.toLocaleString(),[p]),m=e=>{alert(`stake: ${e}`)},c=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return r(N,{children:[s(w,{className:"my-8",src:Y,alt:"advertiser overview"}),r("div",{className:"flex gap-12",children:[s(x,{className:"h-48 flex-1",title:"MeGT",icon:X,children:s("p",{className:"text-48-bold text-neutral-10",children:n})}),s(x,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:B,onStake:m,maxVp:d,children:s("p",{className:"text-48-bold text-neutral-10",children:h})}),s(x,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:r("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${c}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),s(x,{className:"h-48 flex-1",title:"VP Regen Speed",icon:U,children:r("div",{children:[s("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),s("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},ee="/assets/new-site-b7987d2e.svg",te=({className:d,onClick:l,isOpen:n,onClose:p,onCreate:h,children:m})=>{const[c,u]=v.useState(""),e=o=>u(o.target.value),i=o=>{u(""),p(o)};return r(N,{children:[s(C,{className:d,color:"secondary",onClick:l,children:m}),r($,{isOpen:n,onClose:i,children:[s(H,{className:"h-14",children:s(w,{src:ee,alt:"new site"})}),s(J,{children:s(W,{label:"Site URL",value:c,onChange:e,placeholder:"Please enter site URL here"})}),r(q,{children:[s(C,{color:"neutral",onClick:i,children:"CANCEL"}),s(C,{color:"secondary",onClick:o=>{h(c),i(o)},children:"CREATE"})]})]})]})},se="/assets/my-sites-e9cbebca.svg",ae=()=>{const d=a(t=>t.app.MeGTVP),[l,n]=v.useState(!1),p=()=>n(!0),h=()=>n(!1),m=a(t=>t.app.address),c=a(t=>t.app.siteList),u=a(t=>t.app.isAdvertiser),e=a(t=>t.app.daoContract),i=a(t=>t.app.endDate),f=a(t=>t.app.contractSiteList),o=async t=>{const g=Math.floor(new Date().getTime()/1e3)+i*60;try{await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c.length+1,wallet_address:m,url:t})});const A=await T();await(await y(e).createContent(u,g,t,{gasLimit:5e6,gasPrice:A})).wait(),alert("Create Successfully")}catch(A){console.log("Err: ",A)}},b=V();L.useEffect(()=>{fetch("/api/sites").then(t=>{t.text().then(g=>b(k(Array(g))))}).catch(()=>alert("something went wrong"))},[]);const M=t=>t===1?"passed":t===2?"rejected":"process";return r(N,{children:[r("div",{className:"flex justify-between",children:[s(w,{className:"my-8",src:se,alt:"voting list of sites"}),s("div",{className:"flex items-center",children:s(te,{onClick:p,isOpen:l,onClose:h,onCreate:o,children:"NEW SITE"})})]}),s("div",{className:"flex flex-col gap-12",children:f.map((t,g)=>s(z,{id:t.id!==void 0?t.id.toNumber().toString():t.id,url:t.siteUrl,createdAt:new Date(t.createdAt!==void 0?t.createdAt.toNumber()*1e3:0),status:c.length>g?M(c[g].status):"process",expires:new Date(t.endAt!==void 0?t.endAt.toNumber()*1e3:0),ok:t.agreeVoteAmount!==void 0?t.agreeVoteAmount.toNumber():0,ng:t.rejectVoteAmount!==void 0?t.rejectVoteAmount.toNumber():0,maxVp:d},t.id!==void 0?t.id.toNumber():t.id))})]})},le=()=>{const d=a(h=>h.app.address),l=P(),n=V();return r(E,{children:[s(_,{address:d,current:"publisher",onDisconnect:()=>{l("/welcome"),n(D(!0)),n(G(!1)),n(I(!1)),n(O(!1)),n(j(""))}}),s(Z,{}),r("div",{className:"flex gap-12",children:[s("div",{className:"flex-[2_1_0%]",children:s(Q,{})}),s("div",{className:"flex-[3_1_0%]",children:s(ae,{})})]})]})};export{le as Publisher};
