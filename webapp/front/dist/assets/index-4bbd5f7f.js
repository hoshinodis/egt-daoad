import{u as a,r as f,s as L,b as l,F as w,j as t,a as M,e as b,f as P,g as j,h as D,d as G,i as I,k as O}from"./index-1fc2e6d0.js";import{u as A,B as C,C as E,H as _}from"./index-00a528fe.js";import{T as N,C as R,g as T,e as k,O as v,S as B,V as F,f as $,M as H,a as U,b as J,c as W,d as q,h as z,j as K}from"./voting-list-of-sites-f2ca6caa.js";const Q="/assets/voting-list-of-creatives-aa396a27.svg",X=()=>{const p=a(e=>e.app.ADsGTVP);a(e=>e.app.address),a(e=>e.app.siteList),a(e=>e.app.isAdvertiser);const d=a(e=>e.app.daoContract),n=a(e=>e.app.endDate),h=e=>async(r,x)=>{Math.floor(new Date().getTime()/1e3)+n*60;try{const o=await T();await(await k(d).vote(Number(e),r,x,{gasLimit:5e6,gasPrice:o})).wait(),alert("Vote Successfully")}catch(o){console.log("Err: ",o)}},m=A(),g=a(e=>e.app.advertiserList),c=a(e=>e.app.contractAdvertiserList),u=e=>e===1?"passed":e===2?"rejected":"process";return f.useEffect(()=>{fetch("/api/creatives").then(e=>{e.text().then(r=>m(L(Array(r))))}).catch(()=>alert("something went wrong"))},[]),l(w,{children:[t(N,{className:"my-8",src:Q,alt:"my creative"}),t("div",{className:"flex flex-col gap-12",children:c.map((e,r)=>t(R,{id:e.id,createdAt:e.createdAt,expires:e.endAt,link:"https://example.com",image:g[r].img,status:u(g[r].status),ok:e.agreeVoteAmount,ng:e.rejectVoteAmount,maxVp:p,onVote:h(e.id)},e.id))})]})},Y="/assets/gt-b4539d83.svg",Z="/assets/publisher-overview-7c397cd6.svg",ee=()=>{const p=a(e=>e.app.MeGTVP),d=a(e=>e.app.rewardMeAmount),n=f.useMemo(()=>d.toLocaleString(),[d]),h=a(e=>e.app.stakingMeTokenBalance),m=f.useMemo(()=>h.toLocaleString(),[h]),g=e=>{alert(`stake: ${e}`)},c=a(e=>e.app.MeGTVP),u=a(e=>e.app.MeGTVPTime);return l(w,{children:[t(N,{className:"my-8",src:Z,alt:"advertiser overview"}),l("div",{className:"flex gap-12",children:[t(v,{className:"h-48 flex-1",title:"MeGT",icon:Y,children:t("p",{className:"text-48-bold text-neutral-10",children:n})}),t(v,{className:"h-48 flex-1",type:"publisher",title:"Staked MeGT",icon:B,onStake:g,maxVp:p,children:t("p",{className:"text-48-bold text-neutral-10",children:m})}),t(v,{className:"h-48 flex-1",title:"Voting Power (AD)",icon:F,children:l("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${c}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" / 100 VP"})]})}),t(v,{className:"h-48 flex-1",title:"VP Regen Speed",icon:$,children:l("div",{children:[t("p",{className:"text-48-bold text-neutral-10 inline",children:`${u}`}),t("p",{className:"text-28-semi text-neutral-40 inline",children:" VP / day"})]})})]})]})},te="/assets/new-site-b7987d2e.svg",se=({className:p,onClick:d,isOpen:n,onClose:h,onCreate:m,children:g})=>{const[c,u]=f.useState(""),e=o=>u(o.target.value),r=o=>{u(""),h(o)};return l(w,{children:[t(C,{className:p,color:"secondary",onClick:d,children:g}),l(H,{isOpen:n,onClose:r,children:[t(U,{className:"h-14",children:t(N,{src:te,alt:"new site"})}),t(J,{children:t(W,{label:"Site URL",value:c,onChange:e,placeholder:"Please enter site URL here"})}),l(q,{children:[t(C,{color:"neutral",onClick:r,children:"CANCEL"}),t(C,{color:"secondary",onClick:o=>{m(c),r(o)},children:"CREATE"})]})]})]})},ae=()=>{const p=a(s=>s.app.MeGTVP),[d,n]=f.useState(!1),h=()=>n(!0),m=()=>n(!1),g=a(s=>s.app.address),c=a(s=>s.app.siteList),u=a(s=>s.app.isAdvertiser),e=a(s=>s.app.daoContract),r=a(s=>s.app.endDate),x=a(s=>s.app.contractSiteList),o=async s=>{console.log("a;slkdjgalskjg;lajsdlgjadskgj;ajkg");const i=Math.floor(new Date().getTime()/1e3)+r*60;try{await fetch("/api/sites",{method:"POST",body:JSON.stringify({id:c.length+1,wallet_address:g,url:s})});const S=await T();await(await k(e).createContent(u,i,s,{gasLimit:5e6,gasPrice:S})).wait(),alert("Create Successfully")}catch(S){console.log("Err: ",S)}},V=A();M.useEffect(()=>{fetch("/api/sites").then(s=>{s.text().then(i=>V(b(Array(i))))}).catch(()=>alert("something went wrong"))},[]);const y=s=>s===1?"passed":s===2?"rejected":"process";return l(w,{children:[l("div",{className:"flex justify-between",children:[t(N,{className:"my-8",src:z,alt:"voting list of sites"}),t("div",{className:"flex items-center",children:t(se,{onClick:h,isOpen:d,onClose:m,onCreate:o,children:"NEW SITE"})})]}),t("div",{className:"flex flex-col gap-12",children:x.map((s,i)=>t(K,{id:s[i].id,url:c.length>i?c[i].url:"",createdAt:new Date(s[i].createdAt*1e3),status:c.length>i?y(c[i].status):"process",expires:new Date(s[i].endAt*1e3),ok:s[i].agreeVoteAmount,ng:s[i].rejectVoteAmount,maxVp:p},s[i].id))})]})},le=()=>{const p=a(m=>m.app.address),d=P(),n=A();return l(E,{children:[t(_,{address:p,current:"publisher",onDisconnect:()=>{d("/welcome"),n(j(!0)),n(D(!1)),n(G(!1)),n(I(!1)),n(O(""))}}),t(ee,{}),l("div",{className:"flex gap-12",children:[t("div",{className:"flex-[2_1_0%]",children:t(X,{})}),t("div",{className:"flex-[3_1_0%]",children:t(ae,{})})]})]})};export{le as Publisher};
